!function(a){a.extend({websocketSettings:{open:function(){},close:function(){},error:function(){},message:function(){},options:{},events:{},context:this},websocket:function(b,c){var d=WebSocket?new WebSocket(b):{send:function(a){return!1},close:function(){}};return d.binaryType="arraybuffer",a.extend(a.websocketSettings,c),a(d).bind("open",a.websocketSettings.open).bind("close",a.websocketSettings.close).bind("error",a.websocketSettings.error).bind("message",a.websocketSettings.message).bind("message",function(b){var c;if(b.originalEvent.data instanceof ArrayBuffer)(c=a.websocketSettings.events.binaryData)&&c.apply(a.websocketSettings.context,[b.originalEvent]);else{var d=a.evalJSON(b.originalEvent.data);c=a.websocketSettings.events[d.message],c&&c.apply(a.websocketSettings.context,d.data)}}),d._send=d.send,d.send=function(b,c){if(1==d.readyState){var e={message:b};return e=a.extend(!0,e,a.extend(!0,{},a.websocketSettings.options,e)),null!=c&&void 0!==c&&(e.data=[c]),this._send(a.toJSON(e))}return!1},a(window).unload(function(){d.close(),d=null}),d}})}(jQuery);